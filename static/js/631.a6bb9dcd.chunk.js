"use strict";(self.webpackChunkwissen_dashboard=self.webpackChunkwissen_dashboard||[]).push([[631],{3988:function(e,t,n){n.d(t,{Z:function(){return I}});var r=n(1413),a=n(9439),i=n(2791),o=n(5416),s=n(2155),l=n(8745),c=n(5261),u=n(2041),d=n(9195),h=n(4841),f=n(5849),p=n(5771),v=n(6207),g=n(7414),m=n(3006),Z=n(1153),x=n(6314),j=n(5446),z=n(5574),y=n(5661),w=n(4899),C=n(7386),b=n(8820),P=n(5397),k=n(2426),S=n.n(k),B=n(6871),N=n(3504),L=n(8472),A=n(184);function I(e){var t=e.data,n=e.columns,k=e.users,I=e.type,Q=e.assignQuizzMaster,q=e.handleClick,E=e.anchorEl,D=e.popType,R=e.unAssignQuizzMaster,U=e.handleClose,M=e.element,O=e.setElement,T=e.updateRow,_=e.deteleteRow,W=e.inviteUsers,V=e.masters,Y=e.length,F=e.handleChangeRowsPerPage,G=e.rowsPerPage,H=e.page,J=e.handleChangePage,K=(e.getLeagues,Boolean(E)),X=K?"simple-popover":void 0,$=(0,i.useState)([]),ee=(0,a.Z)($,2),te=ee[0],ne=ee[1],re=i.useState(!1),ae=(0,a.Z)(re,2),ie=ae[0],oe=ae[1],se=i.useState(""),le=(0,a.Z)(se,2),ce=le[0],ue=le[1],de=i.useState(""),he=(0,a.Z)(de,2),fe=he[0],pe=he[1],ve=i.useState(""),ge=(0,a.Z)(ve,2),me=ge[0],Ze=ge[1],xe=i.useState(""),je=(0,a.Z)(xe,2),ze=je[0],ye=je[1],we=i.useState([]),Ce=(0,a.Z)(we,2),be=Ce[0],Pe=Ce[1],ke=i.useState(""),Se=(0,a.Z)(ke,2),Be=Se[0],Ne=Se[1],Le=(0,B.s0)(),Ae=i.useRef();(0,i.useEffect)((function(){ne("invite"==D?W:k)}),[D]);var Ie=function(){ue(""),pe(""),Ze(!1),ye(!1),oe(!1)},Qe=function(){U(),Ne("")};return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,A.jsx)(f.Z,{component:N.rU,to:"/leaguesform",variant:"outlined",color:"inherit",disableElevation:!0,children:"private"===I?"Create Private League":"Create Public League"}),(0,A.jsx)(f.Z,{variant:"outlined",color:"info",sx:{float:"right"},onClick:function(){return oe(!0)},children:"Export"})]}),(0,A.jsxs)(h.Z,{Paper:!0,style:{overflow:"auto"},children:[(0,A.jsx)(c.Z,{component:h.Z,children:(0,A.jsxs)(o.Z,{"aria-label":"simple table",size:"small",children:[(0,A.jsx)(u.Z,{children:(0,A.jsx)(d.Z,{children:n.map((function(e,t){return(0,A.jsx)(l.Z,{align:"center",style:{whiteSpace:"nowrap"},width:"Actions"===e.name?"20%":"10%",children:e.name},t)}))})}),(0,A.jsx)(s.Z,{children:t.map((function(e,t){var n,a,i,o;return(0,A.jsxs)(d.Z,{children:[(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:(0,A.jsx)(f.Z,{variant:"text",onClick:function(){Le("/quizzes?league=".concat(e.id))},children:e.title})}),(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:null!==e&&void 0!==e&&e.quizzes?null===e||void 0===e||null===(n=e.quizzes)||void 0===n?void 0:n.length:0}),(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:(0,A.jsx)(p.Z,{label:e.createdByName?e.createdByName:"Not yet",color:e.createdByName?"success":"primary"})}),(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:e.organizer?e.organizer:null!==(a=null===e||void 0===e||null===(i=e.ContactInfo)||void 0===i?void 0:i.firstName)&&void 0!==a?a:""}),(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:S()(e.createdAt).fromNow()}),(0,A.jsx)(l.Z,{align:"center",component:"th",scope:"row",width:"10%",children:e.status}),(0,A.jsx)(l.Z,{align:"center",component:"td",width:"40%",children:(0,A.jsxs)("div",{width:200,children:[(0,A.jsx)(v.ZP,{id:X,open:K,anchorEl:!0,onClose:Qe,anchorOrigin:{vertical:"center",horizontal:"center"},children:(0,A.jsxs)("div",{style:{padding:"1rem",display:"flex",flexDirection:"column",justifyContent:"center",overflowY:"quizzmaster"==D||"invite"==D&&"scroll"},children:["delete"==D||"unAssign"==D?(0,A.jsx)("h3",{children:"Are you sure?"}):"update"==D?(0,A.jsxs)(g.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,A.jsx)(m.Z,{id:"outlined-basic",size:"small",label:"laegue Title?",variant:"outlined",value:null===M||void 0===M?void 0:M.title,style:{paddingBottom:"1rem"},onChange:function(e){return O((0,r.Z)((0,r.Z)({},M),{},{title:e.target.value}))}}),(0,A.jsx)(m.Z,{id:"outlined-basic",size:"small",label:"Organizer?",variant:"outlined",value:null!==M&&void 0!==M&&M.organizer?null===M||void 0===M?void 0:M.organizer:null===M||void 0===M||null===(o=M.ContactInfo)||void 0===o?void 0:o.firstName,style:{paddingBottom:"1rem"},onChange:function(e){return O((0,r.Z)((0,r.Z)({},M),{},{organizer:e.target.value}))}}),(0,A.jsx)(m.Z,{id:"outlined-basic",size:"small",label:"About?",variant:"outlined",value:null===M||void 0===M?void 0:M.description,style:{paddingBottom:"1rem"},onChange:function(e){return O((0,r.Z)((0,r.Z)({},M),{},{description:e.target.value}))}}),(0,A.jsx)(m.Z,{id:"outlined-basic",size:"small",label:"Status?",variant:"outlined",value:null===M||void 0===M?void 0:M.status,style:{paddingBottom:"1rem"},onChange:function(e){return O((0,r.Z)((0,r.Z)({},M),{},{status:e.target.value}))}})]}):"invite"===D?(0,A.jsx)(Z.ZP,{container:!0,sx:{height:"300px"},children:(0,A.jsx)(Z.ZP,{item:!0,sm:12,children:(0,A.jsx)(x.Z,{disablePortal:!0,sx:{width:300},value:Be,options:te.map((function(e){return{label:"".concat(e.firstName," ").concat(e.lastName),value:e.uid}})),onChange:function(e,t){Ne(t)},renderInput:function(e){return(0,A.jsx)(m.Z,(0,r.Z)((0,r.Z)({},e),{},{label:"Select Users",margin:"normal"}))}})})}):(0,A.jsx)(Z.ZP,{container:!0,sx:{height:"300px"},children:(0,A.jsx)(Z.ZP,{item:!0,sm:12,children:(0,A.jsx)(x.Z,{disablePortal:!0,sx:{width:300},value:Be,options:V.map((function(e){return{label:"".concat(e.firstName," ").concat(e.lastName),value:e.uid}})),onChange:function(e,t){Ne(t)},renderInput:function(e){return(0,A.jsx)(m.Z,(0,r.Z)((0,r.Z)({},e),{},{label:"Select Users",margin:"normal"}))}})})}),(0,A.jsxs)(g.Z,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-end",children:["quizzmaster"!==D&&(0,A.jsx)(f.Z,{variant:"outlined",size:"medium",color:"info",onClick:"update"==D?T:"delete"==D?_:R,children:"update"==D?"Update":"invite"==D?"Invite":"Confirm"}),"quizzmaster"===D&&(0,A.jsx)(f.Z,{variant:"outlined",size:"medium",onClick:function(){Q(Be),Ne("")},children:"Invite"}),(0,A.jsx)(f.Z,{variant:"outlined",size:"medium",color:"error",onClick:Qe,children:"Cancel"})]})]})}),(0,A.jsxs)("div",{style:{width:"350px",justifyContent:"space-between",alignItems:"center",display:"flex"},children:[(0,A.jsx)(f.Z,{color:"info",variant:"outlined",size:"small",onClick:function(e){return q(e,"update",t)},children:(0,A.jsx)(b.Z,{})}),"\xa0\xa0\xa0",(0,A.jsx)(f.Z,{color:"error",variant:"outlined",size:"small",onClick:function(e){return q(e,"delete",t)},children:(0,A.jsx)(P.Z,{})}),"\xa0\xa0\xa0",(0,A.jsx)(f.Z,{color:e.createdBy&&e.createdBy?"success":"inherit",variant:"outlined",size:"small",onClick:function(n){e.createdBy&&e.createdBy?q(n,"unAssign",t):q(n,"quizzmaster",t)},children:e.createdBy&&e.createdBy?"Unassign":"Assign QM"},t),"\xa0\xa0\xa0","public"==I&&(0,A.jsx)(f.Z,{color:"error",variant:"outlined",size:"small",onClick:function(e){return q(e,"invite",t)},children:"Invite Users"})]})]})})]},t)}))})]})}),(0,A.jsx)(j.Z,{rowsPerPageOptions:[10,25],component:"div",count:Y,rowsPerPage:G,page:H,onPageChange:J,onRowsPerPageChange:F})]}),(0,A.jsxs)(z.Z,{open:ie,onClose:Ie,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xs",children:[(0,A.jsx)(y.Z,{id:"alert-dialog-title",children:"Please select date range"}),(0,A.jsx)(w.Z,{children:(0,A.jsxs)(Z.ZP,{container:!0,children:[(0,A.jsxs)(Z.ZP,{xs:12,children:[(0,A.jsx)(m.Z,{fullWidth:!0,id:"outlined-basic",margin:"normal",label:"Start date",variant:"outlined",value:ce,onChange:function(e){return ue(e.target.value)},type:"date",InputLabelProps:{shrink:!0}}),me&&(0,A.jsx)("span",{style:{color:"red"},children:"Start Date is required"})]}),(0,A.jsxs)(Z.ZP,{xs:12,children:[(0,A.jsx)(m.Z,{fullWidth:!0,id:"outlined-basic",margin:"normal",label:"End date",variant:"outlined",InputLabelProps:{shrink:!0},type:"date",value:fe,onChange:function(e){return pe(e.target.value)}}),ze&&(0,A.jsx)("span",{style:{color:"red"},children:"End Date is required"})]})]})}),(0,A.jsx)(C.Z,{children:(0,A.jsxs)(g.Z,{direction:"row",spacing:2,children:[(0,A.jsx)(f.Z,{color:"error",variant:"outlined",onClick:Ie,children:"Cancel"}),(0,A.jsx)(f.Z,{color:"primary",variant:"outlined",onClick:function(){try{if(0===ce.length)return void Ze(!0);if(0===fe.length)return void ye(!0);var e=S()(ce).valueOf(),n=S()(fe).valueOf(),r=t.filter((function(t){return t.createdAt>=e&&t.createdAt<=n})).map((function(e){var t;return{"League Name":e.title,"No. of Quizzes":null!==e&&void 0!==e&&e.quizzes?null===e||void 0===e||null===(t=e.quizzes)||void 0===t?void 0:t.length:0,"Quiz Master":e.quizzmaster&&e.quizzmaster?e.quizzmaster:"Not yet","Created By":e.organizer?e.organizer:e.ContactInfo.firstName,"Created On":S()(e.createdAt).fromNow(),Status:e.status}}));Pe(r),Ae.current.link.click(),Ie()}catch(a){console.log(a)}},children:"Export"}),(0,A.jsx)(L.CSVLink,{target:"_blank",ref:Ae,filename:"League_report.csv",data:be})]})})]})]})}},5631:function(e,t,n){n.r(t);var r=n(5987),a=n(1413),i=n(5861),o=n(9439),s=n(4687),l=n.n(s),c=n(4015),u=n(3988),d=n(2791),h=n(4975),f=n(184),p=["createdBy","createdByName"],v=[{name:"League Name"},{name:"No. of Quizzes"},{name:"Quiz Master"},{name:"Created By"},{name:"Created On"},{name:"Status"},{name:"Actions"}];t.default=function(){var e=(0,d.useState)([]),t=(0,o.Z)(e,2),n=t[0],s=t[1],g=(0,d.useState)([]),m=(0,o.Z)(g,2),Z=m[0],x=m[1],j=(0,d.useState)([]),z=(0,o.Z)(j,2),y=z[0],w=z[1],C=(0,d.useState)(null),b=(0,o.Z)(C,2),P=b[0],k=b[1],S=(0,d.useState)(null),B=(0,o.Z)(S,2),N=B[0],L=B[1],A=(0,d.useState)(null),I=(0,o.Z)(A,2),Q=I[0],q=I[1],E=(0,d.useState)(null),D=(0,o.Z)(E,2),R=D[0],U=D[1],M=(0,d.useState)(10),O=(0,o.Z)(M,2),T=O[0],_=O[1],W=(0,d.useState)(0),V=(0,o.Z)(W,2),Y=V[0],F=V[1],G=(0,d.useState)(),H=(0,o.Z)(G,2),J=H[0],K=H[1],X=(0,d.useState)(),$=(0,o.Z)(X,2),ee=$[0],te=$[1],ne=(0,d.useState)(0),re=(0,o.Z)(ne,2),ae=re[0],ie=re[1],oe=(0,d.useState)(!1),se=(0,o.Z)(oe,2),le=(se[0],se[1]);(0,d.useEffect)((function(){ce(),ue(),de()}),[n]);var ce=function(){var e=(0,i.Z)(l().mark((function e(){var t,n,r,a=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:T,e.prev=1,le(!0),(n=h.ZP.firestore().collection("QuizLeague")).limit(t).orderBy("SeasonDetail.endDate","asc").get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1];K(n),s(t),le(!1)})),e.next=7,n.get();case 7:r=e.sent.docs.length,F(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.ZP.firestore().collection("Users").where("userRole","==","Master").get().then((function(e){var t=e.docs.map((function(e){return e.data()}));x(t)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.ZP.firestore().collection("Users").where("userRole","==","Player").get().then((function(e){var t=e.docs.map((function(e){return e.data()}));w(t)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,i.Z)(l().mark((function e(t){var r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.find((function(e,t){return t==P})),i=(0,a.Z)((0,a.Z)({},r),{},{createdByName:t.label,createdBy:t.value}),e.next=5,h.ZP.firestore().collection("QuizLeague").doc(r.id).update(i);case 5:ce(),pe(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,i.Z)(l().mark((function e(){var t,i,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.find((function(e,t){return t==P})),t.createdBy,t.createdByName,i=(0,r.Z)(t,p),o=(0,a.Z)({},i),e.next=6,h.ZP.firestore().collection("QuizLeague").doc(t.id).set(o);case 6:ce(),pe(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){L(null),U(null)},ve=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce(t.target.value);case 3:_(t.target.value),ie(0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.jsx)(c.Z,{title:"Public Leagues",children:(0,f.jsx)(u.Z,{columns:v,data:n&&n,setTableData:s,users:Z,type:"public",assignQuizzMaster:he,handleClick:function(e,t,r){k(r),U(n[r]),q(t),L(e.currentTarget)},setAnchorEl:L,anchorEl:N,setIndex:k,masters:Z,index:P,setPopType:q,popType:Q,unAssignQuizzMaster:fe,handleClose:pe,setElement:U,element:R,updateRow:function(){var e=n.find((function(e,t){return t==P}));h.ZP.firestore().collection("QuizLeague").doc(e.id).update(R).then((function(){ce(),pe()}))},deteleteRow:function(){var e=n.find((function(e,t){return t==P}));h.ZP.firestore().collection("QuizLeague").doc(e.id).delete().then((function(){ce(),pe()}))},inviteUsers:y,handleChangeRowsPerPage:ve,handleChangePage:function(e,t){try{var n=h.ZP.firestore().collection("QuizLeague");le(!0);var r=ae;ie(t),t>r?n.orderBy("SeasonDetail.endDate","asc").limit(T).startAfter(J).get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1],r=e.docs[0];te(r),K(n),s(t),le(!1)})):n.orderBy("SeasonDetail.endDate","asc").limitToLast(T+1).endBefore(ee).get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1],r=e.docs[0];te(r),K(n),s(t),le(!1)}))}catch(a){console.log(a)}},rowsPerPage:T,setLoading:le,page:ae,setPage:ie,length:Y,getLeagues:function(){return ce()}})})}}}]);
//# sourceMappingURL=631.a6bb9dcd.chunk.js.map