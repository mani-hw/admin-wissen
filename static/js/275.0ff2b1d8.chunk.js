"use strict";(self.webpackChunkwissen_dashboard=self.webpackChunkwissen_dashboard||[]).push([[275],{6504:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(1413),o=n(5861),i=n(9439),a=n(4687),s=n.n(a),c=n(4015),l=n(2791),d=n(5416),u=n(2155),p=n(8745),f=n(5261),v=n(2041),h=n(9195),g=n(4841),m=n(5849),Z=n(1554),x=n(7414),j=n(5446),y=n(5574),A=n(5661),P=n(4899),S=n(1153),k=n(3006),b=n(7386),w=n(4975),B=n(2426),C=n.n(B),Q=n(7814),N=n(8472),L=n(184);function T(e){var t=e.data,n=e.columns,r=e.page,a=e.handleChangePage,c=e.length,B=e.setLoading,T=e.loading,E=e.handleChangeRowsPerPage,R=e.rowsPerPage,W=(w.ZP.firestore().collection("Users"),l.useState(null)),q=(0,i.Z)(W,2),U=q[0],J=q[1],_=l.useState(""),z=(0,i.Z)(_,2),G=z[0],I=z[1],O=l.useState(!1),Y=(0,i.Z)(O,2),M=Y[0],V=Y[1],H=l.useState(!1),D=(0,i.Z)(H,2),F=D[0],K=D[1],X=l.useState(""),$=(0,i.Z)(X,2),ee=$[0],te=$[1],ne=l.useState(""),re=(0,i.Z)(ne,2),oe=re[0],ie=re[1],ae=l.useState(""),se=(0,i.Z)(ae,2),ce=se[0],le=se[1],de=l.useState(""),ue=(0,i.Z)(de,2),pe=ue[0],fe=ue[1],ve=l.useState([]),he=(0,i.Z)(ve,2),ge=he[0],me=he[1],Ze=l.useState([]),xe=(0,i.Z)(Ze,2),je=(xe[0],xe[1]),ye=l.useRef(),Ae=function(){te(""),ie(""),le(!1),fe(!1),K(!1)},Pe=function(e,t){J(t),I("approve"===e?"Are you sure to approve this question?":"Are you sure to reject this question?"),V(!0)},Se=function(){V(!1),I(""),J(null)},ke=function(){var e=(0,o.Z)(s().mark((function e(){var t,n,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"Are you sure to reject this question?"!==G){e.next=15;break}return B(!0),e.next=5,w.ZP.firestore().collection("QuestionBank").doc(U.id).update({isApproved:!1},{merge:!0});case 5:return e.next=7,fetch(w.vI,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAAeu1JEGQ:APA91bE9xZmc_aTJj8V2iLrtlNbUyYjrQBPR7gMRUL2ALc6ISVv0G5wfW5GBLtt-JQWXYpmmmV_SQzo9MNDoSWEGHvIeRJgSrSFGjhdk_5PEgR09Zgzdv7KarnF4B_Wj9WbvvJTzHqUj"},body:JSON.stringify({notification:{title:"Question Approval",body:"Your question is not approved."},to:U.createdBy.fcmToken})});case 7:return t=C()().fromNow(),n={createdAt:t,dec:"Your question is not approved.",title:"Question Approval",from:"admin",isClicked:!1,isNotificationSend:!0,recipientUid:U.createdBy.uid,to:"Master",type:"questionApproval",id:t.toString()},e.next=11,w.ZP.firestore().collection("Notification").doc(n.id).set(n);case 11:B(!1),Se(),e.next=26;break;case 15:return B(!0),e.next=18,w.ZP.firestore().collection("QuestionBank").doc(U.id).update({isApproved:!0},{merge:!0});case 18:return e.next=20,fetch(w.vI,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAAeu1JEGQ:APA91bE9xZmc_aTJj8V2iLrtlNbUyYjrQBPR7gMRUL2ALc6ISVv0G5wfW5GBLtt-JQWXYpmmmV_SQzo9MNDoSWEGHvIeRJgSrSFGjhdk_5PEgR09Zgzdv7KarnF4B_Wj9WbvvJTzHqUj"},body:JSON.stringify({notification:{title:"Question Approval",body:"Your question is approved successfully."},to:U.createdBy.fcmToken})});case 20:return r=C()().fromNow(),o={createdAt:r,dec:"Your question is approved successfully.",title:"Question Approval",from:"admin",isClicked:!1,isNotificationSend:!0,recipientUid:U.createdBy.uid,to:"Master",type:"questionApproval",id:r.toString()},e.next=24,w.ZP.firestore().collection("Notification").doc(o.id).set(o);case 24:B(!1),Se();case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.log(e.t0);case 31:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=(0,o.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.ZP.firestore().collection("Users").get();case 3:t=e.sent.docs.map((function(e){return e.data()})),je(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return l.useEffect((function(){be()}),[]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{children:(0,L.jsx)(m.Z,{variant:"outlined",color:"info",sx:{float:"right"},onClick:function(){return K(!0)},children:"Export"})}),T&&(0,L.jsx)("div",{style:{marginLeft:"30rem",marginTop:"8rem",position:"absolute"},children:(0,L.jsx)(Z.Z,{style:{position:"absolute"}})}),(0,L.jsxs)(g.Z,{children:[(0,L.jsx)(f.Z,{component:g.Z,children:(0,L.jsxs)(d.Z,{"aria-label":"simple table",sx:{minWidth:650},size:"small",children:[(0,L.jsx)(v.Z,{children:(0,L.jsx)(h.Z,{children:n.map((function(e,t){return(0,L.jsx)(p.Z,{align:"center",style:{whiteSpace:"nowrap"},children:e.name},t)}))})}),(0,L.jsx)(u.Z,{children:t.map((function(e){return(0,L.jsxs)(h.Z,{children:[(0,L.jsx)(p.Z,{component:"td",align:"center",children:null===e||void 0===e?void 0:e.Question}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:null===e||void 0===e?void 0:e.level}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:null===e||void 0===e?void 0:e.type}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:"".concat(null===e||void 0===e?void 0:e.createdBy.firstName," ").concat(null===e||void 0===e?void 0:e.createdBy.lastName)}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:null===e||void 0===e?void 0:e.Genre}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:C()(null===e||void 0===e?void 0:e.createdAt).fromNow()}),(0,L.jsx)(p.Z,{component:"td",align:"center",children:(0,L.jsxs)(x.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:2,children:[(0,L.jsx)(m.Z,{variant:"outlined",size:"small",onClick:function(){return Pe("approve",e)},children:"Approve"}),(0,L.jsx)(m.Z,{variant:"outlined",size:"small",color:"error",style:{marginleft:"20px"},onClick:function(){return Pe("reject",e)},children:"Reject"})]})})]},null===e||void 0===e?void 0:e.uid)}))})]})}),(0,L.jsx)(j.Z,{rowsPerPageOptions:[10,25],component:"div",count:c,rowsPerPage:R,page:r,onPageChange:a,onRowsPerPageChange:E})]})]}),(0,L.jsxs)(y.Z,{open:F,onClose:Ae,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xs",children:[(0,L.jsx)(A.Z,{id:"alert-dialog-title",children:"Please select date range"}),(0,L.jsx)(P.Z,{children:(0,L.jsxs)(S.ZP,{container:!0,children:[(0,L.jsxs)(S.ZP,{xs:12,children:[(0,L.jsx)(k.Z,{fullWidth:!0,id:"outlined-basic",margin:"normal",label:"Start date",variant:"outlined",value:ee,onChange:function(e){return te(e.target.value)},type:"date",InputLabelProps:{shrink:!0}}),ce&&(0,L.jsx)("span",{style:{color:"red"},children:"Start Date is required"})]}),(0,L.jsxs)(S.ZP,{xs:12,children:[(0,L.jsx)(k.Z,{fullWidth:!0,id:"outlined-basic",margin:"normal",label:"End date",variant:"outlined",InputLabelProps:{shrink:!0},type:"date",value:oe,onChange:function(e){return ie(e.target.value)}}),pe&&(0,L.jsx)("span",{style:{color:"red"},children:"End Date is required"})]})]})}),(0,L.jsx)(b.Z,{children:(0,L.jsxs)(x.Z,{direction:"row",spacing:2,children:[(0,L.jsx)(m.Z,{color:"error",variant:"outlined",onClick:Ae,children:"Cancel"}),(0,L.jsx)(m.Z,{color:"primary",variant:"outlined",onClick:function(){try{if(0===ee.length)return void le(!0);if(0===oe.length)return void fe(!0);var e=C()(ee).valueOf(),n=C()(oe).valueOf(),r=t.filter((function(t){return t.createdAt>=e&&t.createdAt<=n})).map((function(e){return{Question:e.title,Level:e.level,Type:e.type,Topic:e.genre,"Created By":"".concat(null===e||void 0===e?void 0:e.createdBy.firstName," ").concat(null===e||void 0===e?void 0:e.createdBy.lastName),"Created On":C()(null===e||void 0===e?void 0:e.createdAt).fromNow()}}));me(r),ye.current.link.click(),Ae()}catch(o){console.log(o)}},children:"Export"}),(0,L.jsx)(N.CSVLink,{target:"_blank",filename:"User_report.csv",data:ge,ref:ye})]})})]}),(0,L.jsx)(Q.Z,{open:M,confirmHandler:ke,cancelHandler:Se,message:G})]})}var E=[{name:"Question"},{name:"Level"},{name:"Type"},{name:"Created By"},{name:"Topic"},{name:"Created On"},{name:"Actions"}];var R=function(){var e=(0,l.useState)([]),t=(0,i.Z)(e,2),n=t[0],a=t[1],d=(0,l.useState)(),u=(0,i.Z)(d,2),p=u[0],f=u[1],v=(0,l.useState)(),h=(0,i.Z)(v,2),g=h[0],m=h[1],Z=(0,l.useState)(0),x=(0,i.Z)(Z,2),j=x[0],y=x[1],A=(0,l.useState)(0),P=(0,i.Z)(A,2),S=P[0],k=P[1],b=(0,l.useState)(!1),B=(0,i.Z)(b,2),C=B[0],Q=B[1],N=(0,l.useState)(10),R=(0,i.Z)(N,2),W=R[0],q=R[1],U=w.ZP.firestore().collection("QuestionBank"),J=function(){var e=(0,o.Z)(s().mark((function e(){var t,n,o,i,c,l=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:W,Q(!0),n=w.ZP.firestore().collection("Users"),e.next=5,n.get();case 5:return o=e.sent,i=o.docs.map((function(e){return e.data()})),U.orderBy("createdAt","desc").limit(t).get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1],o=t.map((function(e){if(e.createdBy){var t=i.filter((function(t){return t.uid===e.createdBy}));return 0===t.length?(0,r.Z)((0,r.Z)({},e),{},{createdBy:null}):(0,r.Z)((0,r.Z)({},e),{},{createdBy:t[0]})}return(0,r.Z)((0,r.Z)({},e),{},{createdBy:null})})).filter((function(e){var t;return"Master"===(null===e||void 0===e||null===(t=e.createdBy)||void 0===t?void 0:t.userRole)&&!e.isApproved}));a(o),f(n),Q(!1)})),e.next=10,U.where("isBlocked","==",!1).get();case 10:c=e.sent.docs.length,k(c);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,o.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,getUsers(t.target.value);case 3:q(t.target.value),y(0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){J()}),[]),(0,L.jsx)(c.Z,{title:"Approved Questions",children:(0,L.jsx)(T,{columns:E,data:n&&n,setTableData:a,type:"Active",page:j,setPage:y,handleChangePage:function(e,t){Q(!0);var n=j;y(t),t>n?U.orderBy("createdAt","desc").limit(W).startAfter(p).where("isBlocked","==",!1).get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1],r=e.docs[0];m(r),f(n),a(t),Q(!1)})):U.orderBy("createdAt","desc").limitToLast(W+1).endBefore(g).where("isBlocked","==",!1).get().then((function(e){var t=e.docs.map((function(e){return e.data()})),n=e.docs[e.docs.length-1],r=e.docs[0];m(r),f(n),a(t),Q(!1)}))},length:S,setLoading:Q,rowsPerPage:W,loading:C,handleChangeRowsPerPage:_})})}}}]);
//# sourceMappingURL=275.0ff2b1d8.chunk.js.map